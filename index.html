<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Continuant AI Discovery Chatbot Demo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f3f4f6;
            margin: 0;
            padding: 20px;
        }
        #chat-container {
            position: fixed;
            top: 200px;
            left: 50%;
            transform: translateX(-50%);
            width: 320px;
            height: 400px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            z-index: 1000;
        }
        #chat-header {
            background-color: #3b82f6;
            color: white;
            padding: 6px;
            font-size: 14px;
            font-weight: bold;
            text-align: center;
        }
        #chat-output {
            height: 240px;
            overflow-y: auto;
            border: 1px solid #e5e7eb;
            padding: 6px;
            margin: 6px;
            border-radius: 4px;
            font-size: 12px;
        }
        .message {
            margin: 4px 0;
            padding: 4px;
            border-radius: 4px;
            font-size: 12px;
        }
        .bot-message {
            background-color: #e5e7eb;
        }
        .user-message {
            background-color: #3b82f6;
            color: white;
            text-align: right;
        }
        #chat-input {
            width: calc(100% - 12px);
            padding: 6px;
            margin: 6px;
            border: 1px solid #e5e7eb;
            border-radius: 4px;
            font-size: 12px;
        }
        #options-container {
            margin: 6px;
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
        }
        .option-button {
            background-color: #3b82f6;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 11px;
        }
        .option-button:hover {
            background-color: #2563eb;
        }
        .admin-note {
            background-color: #fefcbf;
            padding: 6px;
            margin: 6px;
            border-radius: 4px;
            font-size: 11px;
            overflow-y: auto;
            max-height: 80px;
        }
        #toggle-chat {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #3b82f6;
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            z-index: 1001;
            font-size: 24px;
        }
        #toggle-chat:hover {
            background-color: #2563eb;
        }
        @media (max-width: 480px) {
            #chat-container {
                width: 90%;
                height: 350px;
                top: 200px;
                left: 50%;
                transform: translateX(-50%);
            }
            #chat-output {
                height: 200px;
            }
        }
    </style>
</head>
<body>
    <div id="sample-content">
        <h1 class="text-lg text-center mb-4">Continuant AI Discovery Agent</h1>
        <p class="text-lg text-center">This is a sample page to demonstrate the AI Discovery Chatbot widget. The chatbot opens automatically below this text. Use the bottom-right icon to toggle it.</p>
    </div>

    <div id="chat-container">
        <div id="chat-header">Continuant AI Discovery Agent</div>
        <div class="admin-note">
            <p><strong>Note for HubSpot Admins:</strong> Responses are logged to the console (F12 > Console). For live integration, replace <code>YOUR_PORTAL_ID</code> and <code>YOUR_FORM_GUID</code> with HubSpot credentials and create a form with matching fields.</p>
        </div>
        <div id="chat-output"></div>
        <input id="chat-input" type="text" placeholder="Type your response...">
        <div id="options-container"></div>
    </div>

    <div id="toggle-chat" title="Toggle Chatbot">âœ–</div>

    <script>
        // Placeholder HubSpot Forms API configuration
        const HUBSPOT_PORTAL_ID = 'YOUR_PORTAL_ID'; // Replace with HubSpot Portal ID for live integration
        const HUBSPOT_FORM_GUID = 'YOUR_FORM_GUID'; // Replace with HubSpot Form GUID for live integration

        const questions = [
            {
                text: "What are your top business priorities for the next 12â€“18 months?",
                options: ["Cost reduction", "Customer experience", "Operational efficiency", "Other (please specify)"],
                key: "business_priorities"
            },
            {
                text: "How does your leadership measure success for IT investments?",
                options: ["ROI", "Customer satisfaction", "Efficiency gains", "Other (please specify)"],
                key: "success_metrics"
            },
            {
                text: "Whatâ€™s the biggest bottleneck in your customer service or operations?",
                options: ["Slow response times", "Manual processes", "Data silos", "Other (please specify)"],
                key: "ai_bottleneck"
            },
            {
                text: "How much time is lost to manual processes daily? (Estimate in hours)",
                options: ["Less than 1 hour", "1â€“3 hours", "3â€“5 hours", "More than 5 hours", "Other (please specify)"],
                key: "time_lost"
            },
            {
                text: "What systems are you using for customer interactions or data analysis?",
                options: ["Legacy systems", "Cloud-based tools", "Custom software", "Other (please specify)"],
                key: "current_systems"
            },
            {
                text: "Have you explored AI tools, and whatâ€™s your experience?",
                options: ["Not yet explored", "Tried but not satisfied", "Using successfully", "Other (please specify)"],
                key: "ai_experience"
            },
            {
                text: "Whatâ€™s your budget range for addressing these challenges?",
                options: ["Under $10,000", "$10,000â€“$50,000", "$50,000â€“$100,000", "Over $100,000", "Other (please specify)"],
                key: "budget_range"
            },
            {
                text: "Who else is involved in evaluating AI solutions?",
                options: ["IT team", "C-level executives", "Finance team", "Other (please specify)"],
                key: "decision_makers"
            },
            {
                text: "What would success look like for solving your key challenges?",
                options: ["Cost savings", "Improved customer satisfaction", "Faster processes", "Other (please specify)"],
                key: "success_outcomes"
            }
        ];

        let currentQuestionIndex = 0;
        const responses = {};
        const userEmail = prompt("Please enter your email to start the questionnaire (for follow-up):");

        const chatContainer = document.getElementById('chat-container');
        const chatOutput = document.getElementById('chat-output');
        const chatInput = document.getElementById('chat-input');
        const optionsContainer = document.getElementById('options-container');
        const toggleChat = document.getElementById('toggle-chat');

        function displayMessage(message, type) {
            const div = document.createElement('div');
            div.className = `message ${type}`;
            div.textContent = message;
            chatOutput.appendChild(div);
            chatOutput.scrollTop = chatOutput.scrollHeight;
        }

        function displayOptions(options) {
            optionsContainer.innerHTML = '';
            options.forEach(option => {
                const button = document.createElement('button');
                button.className = 'option-button';
                button.textContent = option;
                button.onclick = () => handleOptionClick(option);
                optionsContainer.appendChild(button);
            });
        }

        function handleOptionClick(option) {
            if (option === "Other (please specify)") {
                chatInput.style.display = 'block';
                chatInput.focus();
            } else {
                saveResponse(option);
                displayMessage(option, 'user-message');
                moveToNextQuestion();
            }
        }

        function saveResponse(response) {
            responses[questions[currentQuestionIndex].key] = response;
            localStorage.setItem('ai_discovery_responses', JSON.stringify(responses));
            console.log('Response saved:', { key: questions[currentQuestionIndex].key, value: response });
        }

        function submitToHubSpot() {
            const formData = {
                fields: [
                    { name: 'email', value: userEmail },
                    ...Object.keys(responses).map(key => ({ name: key, value: responses[key] }))
                ],
                context: {
                    pageUri: window.location.href,
                    pageName: document.title
                }
            };
            console.log('Simulated HubSpot submission:', formData);
            // Uncomment for live integration
            /*
            fetch(`https://api.hsforms.com/submissions/v3/integration/submit/${HUBSPOT_PORTAL_ID}/${HUBSPOT_FORM_GUID}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(formData)
            })
            .then(response => response.json())
            .then(data => console.log('Form submitted:', data))
            .catch(error => console.error('Error submitting to HubSpot:', error));
            */
        }

        function moveToNextQuestion() {
            currentQuestionIndex++;
            if (currentQuestionIndex < questions.length) {
                displayMessage(questions[currentQuestionIndex].text, 'bot-message');
                displayOptions(questions[currentQuestionIndex].options);
                chatInput.style.display = 'none';
            } else {
                displayMessage("Thank you for completing the questionnaire! We'll follow up with tailored AI recommendations.", 'bot-message');
                optionsContainer.innerHTML = '';
                chatInput.style.display = 'none';
                submitToHubSpot();
            }
        }

        chatInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && chatInput.value.trim()) {
                const response = chatInput.value.trim();
                displayMessage(response, 'user-message');
                saveResponse(response);
                chatInput.value = '';
                moveToNextQuestion();
            }
        });

        toggleChat.addEventListener('click', () => {
            if (chatContainer.style.display === 'flex') {
                chatContainer.style.display = 'none';
                toggleChat.textContent = 'ðŸ’¬';
            } else {
                chatContainer.style.display = 'flex';
                toggleChat.textContent = 'âœ–';
            }
        });

        function startChat() {
            if (userEmail) {
                displayMessage("Welcome to Continuantâ€™s AI Discovery Chatbot! Letâ€™s explore how AI can help your business. " + questions[0].text, 'bot-message');
                displayOptions(questions[0].options);
            } else {
                displayMessage("Please provide a valid email to continue.", 'bot-message');
            }
        }

        startChat();
    </script>
</body>
</html>
